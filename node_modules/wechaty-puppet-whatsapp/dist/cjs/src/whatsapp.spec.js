#!/usr/bin/env node --no-warnings --loader ts-node/esm
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tstest_1 = require("tstest");
const whatsapp_js_1 = require("./whatsapp.js");
(0, tstest_1.test)('getWhatsApp() QR Code & Destroy', async (t) => {
    const whatsapp = await (0, whatsapp_js_1.getWhatsApp)();
    try {
        const future = new Promise(resolve => whatsapp.once('qr', resolve));
        let closing = false;
        whatsapp.initialize()
            .catch(e => {
            if (!closing) {
                t.fail(e);
            }
        });
        const timer = setTimeout(() => t.fail('timeout'), 15 * 1000);
        await future;
        clearTimeout(timer);
        t.pass('whatsapp qr code received');
        closing = true;
        await whatsapp.destroy();
    }
    catch (e) {
        t.fail(e);
    }
});
//# sourceMappingURL=whatsapp.spec.js.map